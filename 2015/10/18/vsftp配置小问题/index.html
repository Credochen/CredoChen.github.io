<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> VSFTP配置 · Brightness</title><meta name="description" content="VSFTP配置 - Guangpeng Chen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">VSFTP配置</h1><div class="post-meta"><div class="post-time">Oct 18, 2015</div></div><div class="post-content"><p>###VSFTP配置——禁止访问上级目录<br>1.修改/etc/vsftpd.conf,修改以下三个参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chroot_local_user=NO  &#10;chroot_list_enable=YES  &#10;chroot_list_file=/etc/vsftpd/chroot_list</span><br></pre></td></tr></table></figure></p>
<p>2.此时可能会出现<code>500 OOPS: vsftpd: refusing to run with writable root inside chroot()</code>这样的错误，<br>解决方法：<br>在<code>/etc/vsftpd.conf</code>中添加<code>allow_writeable_chroot=YES</code><br>参考：<a href="http://stackoverflow.com/questions/22420177/500-oops-vsftpd-refusing-to-run-with-writable-root-inside-chroot-login-faile" target="_blank" rel="external">500 OOPS: vsftpd: refusing to run with writable root inside chroot() Login failed on debian</a><br>3.注意文件夹权限（将文件夹权限改为755OK）<br>4.SELINUX可能会导致文件无法上传等问题，<br>解决方法：</p>
<p>1). 降低SELinux安全级别，把enforcing降低到permissive<br><code>vi /etc/sysconfig/selinux</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;\# This file controls the state of SELinux on the system.&#10;&#10;\# SELINUX= can take one of these three values:&#10;&#10;\#       enforcing - SELinux security policy is enforced.&#10;&#10;\#       permissive - SELinux prints warnings instead of enforcing.&#10;&#10;\#       disabled - SELinux is fully disabled.&#10;SELINUX=permissive</span><br></pre></td></tr></table></figure>
<p>2).经过研究，又找到了另一个更理想的办法。首先查看SELinux中有关FTP的设置状态：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;getsebool -a|grep ftp&#10;&#10;allow_ftpd_anon_write --&#62; off&#10;&#10;allow_ftpd_full_access --&#62; off&#10;&#10;allow_ftpd_use_cifs --&#62; off&#10;&#10;allow_ftpd_use_nfs --&#62; off&#10;&#10;allow_tftp_anon_write --&#62; off&#10;&#10;ftp_home_dir --&#62; off&#10;&#10;ftpd_connect_db --&#62; off&#10;&#10;ftpd_disable_trans --&#62; on&#10;&#10;ftpd_is_daemon --&#62; on&#10;&#10;httpd_enable_ftp_server --&#62; off&#10;&#10;tftpd_disable_trans --&#62; off</span><br></pre></td></tr></table></figure>
<p>参考：<a href="http://www.esojourn.org/blog/read.php/313.htm" target="_blank" rel="external">修改SELinux设置，使vsftp在enforcing security enhance模式下正常运行</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/2015/10/18/查看 MySQL 数据库中每个表占用的空间大小/" class="prev">上一篇</a><a href="/2015/10/18/PHP引用/" class="next">下一篇</a></div><div class="copyright"><p>© 2016 <a href="http://guangpeng.me">Guangpeng Chen</a>, unless otherwise noted.</p></div></footer><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>